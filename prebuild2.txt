<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<PropertyGroup>
		<IntermediateOutputPath Condition="$(IntermediateOutputPath) == '' Or $(IntermediateOutputPath) == '*Undefined*'">$(MSBuildProjectDirectory)\obj\$(Configuration)\</IntermediateOutputPath>
		<CodeGeneratedFile>$(IntermediateOutputPath)DefensiveCacheImplemented.g.cs</CodeGeneratedFile>
	</PropertyGroup>
	<UsingTask
	  TaskName="PrintMessage"
	  TaskFactory="CodeTaskFactory"
	  AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.Core.dll" >
		<ParameterGroup>
			<Text Required="true" />
		</ParameterGroup>
		<Task>
			<Using Namespace="System"/>
			<Using Namespace="System.IO"/>
			<Code Type="Fragment" Language="cs">
				<![CDATA[Log.LogWarning(Text);]]>
			</Code>
		</Task>
	</UsingTask>
	<!--<UsingTask TaskName="CoreApp.DefensiveCache.BuildTasks.GenerateStubsTask"
			   AssemblyFile="$(MSBuildThisFileDirectory)..\..\build\netstandard2.0\CoreApp.DefensiveCache.BuildTasks.dll" >
	</UsingTask>-->
	<!--<Target Name="GenerateDefensiveCache" BeforeTargets="BeforeCompile;CoreCompile" Inputs="@(Compile)" Outputs="$(CodeGeneratedFile)" Condition="$(Language) == 'C#'">
		<PrintMessage Text="My custom alert"/>
		<GenerateStubsTask SourceFiles="@(Compile)" BaseDirectory="$(MSBuildProjectDirectory)" OutputFile="$(CodeGeneratedFile)"/>
		<ItemGroup Condition="Exists('$(CodeGeneratedFile)')">
			<Compile Include="$(CodeGeneratedFile)" />
			<FileWrites Include="$(CodeGeneratedFile)" />
		</ItemGroup>
	</Target>-->
	<Target Name="MyAfterBuild" AfterTargets="Build">
		<PropertyGroup>
			<Building>true</Building>
		</PropertyGroup>
		<ItemGroup>
			<FilesToDelete Include="$(OutputPath)**\*" />
		</ItemGroup>
		<PrintMessage Text="MyAfterBuild!"/>
		<!--<Warning Text="My warning"/>-->
		<!--<Delete Files="@(FilesToDelete)" />-->
		<!--<Move SourceFiles="@(FilesToDelete)" OverwriteReadOnlyFiles="true" DestinationFolder="$(OutputPath)\copy"/>-->
		<!--<PrintMessage Text="Project: $(MSBuildProjectFile)"/>-->
		<!--<MSBuild Projects="$(MSBuildProjectFile)" Targets="Build" />-->
	</Target>
	<UsingTask TaskName="CoreApp.DefensiveCache.BuildTasks.GenerateStubsFromAssemblyTask"
		   AssemblyFile="C:\Projetos\github\DefensiveCache\CoreApp.DefensiveCache.BuildTasks\bin\Release\netstandard2.0\CoreApp.DefensiveCache.BuildTasks.dll" >
	</UsingTask>
	<Target Name="MyBeforeBuild" BeforeTargets="Build" Condition="$(MyPrebuild) == ''">
		<PrintMessage Text="MyBeforeBuild!"/>
		<MSBuild Projects="$(MSBuildProjectFile)" Properties="MyPrebuild=true;">
			<Output ItemName="ProjectOutputs" TaskParameter="TargetOutputs"/>
		</MSBuild>
		<!--<Warning Text="ProjectOutputs: @(ProjectOutputs)" />-->
		<GenerateStubsFromAssemblyTask AssemblyPath="@(ProjectOutputs)" BaseDirectory="$(MSBuildProjectDirectory)" OutputFile="$(CodeGeneratedFile)"/>
	</Target>
	<!--<UsingTask TaskName="CoreApp.DefensiveCache.BuildTasks.GenerateStubsFromAssemblyTask"
		   AssemblyFile="C:\Projetos\github\DefensiveCache\CoreApp.DefensiveCache.BuildTasks\bin\Debug\netstandard2.0\CoreApp.DefensiveCache.BuildTasks.dll" >
	</UsingTask>-->
	<!--<Target Name="GenerateDefensiveCacheFromAssemby" AfterTargets="MyBeforeBuild" Inputs="@(FileWrites)"  Outputs="$(CodeGeneratedFile)" Condition="$(Language) == 'C#' and $(MyPrebuild) == 'true'">
		
		<PrintMessage Text="OutputPath @(OutputPath)"/>
		--><!--<Warning Text="FileWrites__: @(FileWrites)" />--><!--
		<GenerateStubsFromAssemblyTask SourceFiles="@(FileWrites)" BaseDirectory="$(MSBuildProjectDirectory)" OutputFile="$(CodeGeneratedFile)"/>
	</Target>-->
	<!--<Target Name="AfterBuild">
		<Warning Text="FileWrites: @(FileWrites)" />
	</Target>-->
</Project>